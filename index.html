<!DOCTYPE html> 
<html lang="en"> 
<head> 
  <title>Crismaaaas</title>
</head>

<style>
  body {
    margin: 0;
    overflow: hidden;
  }
  #boton {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-size: 40px;
    cursor: pointer;
    z-index: 10;
    
  }
  #activ {
    color: rgba(0, 255, 64, 0.87);
  }
</style>

<body>
  <!-- Botón para activar el pointerlock -->
  <div id="boton">
    Para comenzar da clic en + para activar 
    <p id="activ">( + )</p>
    Mira al rededor usando el mouse, pulsa Esc para parar
  </div>

  <canvas id="myCanvas"></canvas>

  <!-- Librerías -->
  <script type="importmap">
    {
      "imports": {
        "three": "./js/three.module.js",
        "three/PointerLockControls": "./js/PointerLockControls.js",
        "three/interactive": "./js/three.interactive.js"
      }
    }
  </script>

  <script type="module">
    import * as THREE from 'three';
    import { InteractionManager } from 'three/interactive';
    import { TWEEN } from './js/tween.module.min.js';
    import { PointerLockControls } from 'three/PointerLockControls';

    import obj1 from './models/arbol.js';
    import obj2 from './models/mcdonals.js';
    import obj3 from './models/muñeco.js';
    import obj4 from './models/esfera.js';
    import obj5 from './models/montañas.js';
    import obj6 from './models/casa.js';
    import obj7 from './models/pingu.js';

    // Renderer
    const renderer = new THREE.WebGLRenderer({
      canvas: document.getElementById('myCanvas'),
      antialias: true,
    });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setClearColor(0x70707C);

    // Escena
    var scene = new THREE.Scene();

    // Cámara
    var camera = new THREE.PerspectiveCamera(
      50,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );
    camera.position.set(0, 15, 100);
    camera.lookAt(0, 0, 0);

    // PointerLock
    var controls = new PointerLockControls(camera, renderer.domElement);
    var boton = document.getElementById('boton');
    var activ = document.getElementById('activ');

    activ.onclick = () => {
      controls.lock();
    };
    controls.addEventListener('lock', () => {
      boton.style.display = 'none';
    });
    controls.addEventListener('unlock', () => {
      boton.style.display = '';
    });

    // Interaction Manager
    var interactionManager = new InteractionManager(
      renderer,
      camera,
      renderer.domElement
    );

    // Luz
    var light = new THREE.AmbientLight(0xeeeeee, 0.8);
    light.position.set(50, 50, 50);
    scene.add(light);

    // Fondo
    var loader = new THREE.TextureLoader();
    var bgTexture = loader.load('./image/paisaje.jpg');
    scene.background = bgTexture;

    // Piso
    var pisoGeometry = new THREE.BoxGeometry(800, 0.5, 800);
    var pisoMaterial = new THREE.MeshLambertMaterial({ color: 0x96CEB4 });
    var piso = new THREE.Mesh(pisoGeometry, pisoMaterial);
    piso.position.y = -5;
    scene.add(piso);

    // Árbol
    var arbol = new obj1({ x: 0, y: 0, z: 0 });
    arbol.scale.set(2, 2, 2);
    arbol.position.set(-50,  0,-50);
    scene.add(arbol);

    var arbol01= new obj1({ x: 0, y: 0, z: 0 });
    arbol01.scale.set(2, 2, 2);
    arbol01.position.set(-80,  0,-80);
    scene.add(arbol01);

    var arbol02= new obj1({ x: 0, y: 0, z: 0 });
    arbol02.scale.set(2, 2, 2);
    arbol02.position.set(-40,  0,-90);
    scene.add(arbol02);

    var arbol03= new obj1({ x: 0, y: 0, z: 0 });
    arbol03.scale.set(2, 2, 2);
    arbol03.position.set(-90,  0,-55);
    scene.add(arbol03);
    

    //Arbol Centrado
        arbol.addEventListener('mouseover', (event) => {  //Evento para cuando colocamos el cursor sobre la figura
          document.body.style.cursor = 'pointer';
          event.target.scale.set(2.3,2.3,2.3);
        });

        arbol.addEventListener('mouseout', (event) => {  //evento para cuando quitas el cursor de la figura, si no se agrega se le quedara el color que se puso en el mouseover
           document.body.style.cursor = 'default';
           event.target.scale.set(2,2,2);
        });

        arbol.addEventListener('click', (event) => { //evento para cuando se suelta el clic
          var coords = { x: camera.position.x, y: camera.position.y, z: camera.position.z };// se crea un objeto para "contener" las coordenadas
          event.target.scale.set(1.8,1.8,1.8);  
          new TWEEN.Tween(coords) //Se declara el TWEEN, que permite que los movimientos sean fluidos y no de golpe 
          .to({x:-50, y:25, z: 10}) //se indican los cambios que se presentaran y en que variables, INDICA LA POSICIÓN FINAL DE MOVIMIENTO
          .onUpdate(() => camera.position.set(coords.x,coords.y,coords.z )  //Se actualizan las vartiables en el objetivo del movimiento SE ACTUALIZAN LAS VARIABLES EN LA CAMARA
          )
          .start();//El movimiento inicia
        });

    // Regalo
    var mcdonals = new obj2({ x: 50, y: 0, z: -50 });
    mcdonals.scale.set(1.5, 1.5, 1.5);
    scene.add(mcdonals);

    var mcdonals01 = new obj2({ x: 60, y: 0, z: -30 });
    mcdonals01.scale.set(1, 1, 1);
    scene.add(mcdonals01);
    
    var mcdonals02 = new obj2({ x: 40, y: 0, z: -60 });
    mcdonals02.scale.set(0.8, 2, 0.8);
    scene.add(mcdonals02); 

    //Regalo Centrado
        mcdonals.addEventListener('mouseover', (event) => {  //Evento para cuando colocamos el cursor sobre la figura
          document.body.style.cursor = 'pointer';
          event.target.scale.set(1.8,1.8,1.8);
        });

        mcdonals.addEventListener('mouseout', (event) => {  //evento para cuando quitas el cursor de la figura, si no se agrega se le quedara el color que se puso en el mouseover
           document.body.style.cursor = 'default';
           event.target.scale.set(1.5,1.5,1.5);
        });

        mcdonals.addEventListener('click', (event) => { //evento para cuando se suelta el clic
          var coords = { x: camera.position.x, y: camera.position.y, z: camera.position.z };// se crea un objeto para "contener" las coordenadas
          event.target.scale.set(1.3,1.3,1.3);  
          new TWEEN.Tween(coords) //Se declara el TWEEN, que permite que los movimientos sean fluidos y no de golpe 
          .to({x:50, y:10, z: 10}) //se indican los cambios que se presentaran y en que variables, INDICA LA POSICIÓN FINAL DE MOVIMIENTO
          .onUpdate(() => camera.position.set(coords.x,coords.y,coords.z )  //Se actualizan las vartiables en el objetivo del movimiento SE ACTUALIZAN LAS VARIABLES EN LA CAMARA
          )
          .start();//El movimiento inicia
        });

    // Muñeco de nieve
    var muñeco = new obj3({ x: -90, y: 0, z: 90 });
    muñeco.scale.set(2, 2, 2);
    scene.add(muñeco);

    var muñeco01 = new obj3({ x: -60, y: 0, z: 70 });
    muñeco01.scale.set(2, 2, 2);
    muñeco01.rotation.set(1.5,-0.5,0)
    scene.add(muñeco01);

    //Muñeco de nieve Centrado
        muñeco.addEventListener('mouseover', (event) => {  //Evento para cuando colocamos el cursor sobre la figura
          document.body.style.cursor = 'pointer';
          event.target.scale.set(2.3,2.3,2.3);
        });

        muñeco.addEventListener('mouseout', (event) => {  //evento para cuando quitas el cursor de la figura, si no se agrega se le quedara el color que se puso en el mouseover
           document.body.style.cursor = 'default';
           event.target.scale.set(2,2,2);
        });

        muñeco.addEventListener('click', (event) => { //evento para cuando se suelta el clic
          var coords = { x: camera.position.x, y: camera.position.y, z: camera.position.z };// se crea un objeto para "contener" las coordenadas
          event.target.scale.set(1.8,1.8,1.8);  
          new TWEEN.Tween(coords) //Se declara el TWEEN, que permite que los movimientos sean fluidos y no de golpe 
          .to({x:-50, y:25, z: 109}) //se indican los cambios que se presentaran y en que variables, INDICA LA POSICIÓN FINAL DE MOVIMIENTO
          .onUpdate(() => camera.position.set(coords.x,coords.y,coords.z )  //Se actualizan las vartiables en el objetivo del movimiento SE ACTUALIZAN LAS VARIABLES EN LA CAMARA
          )
          .start();//El movimiento inicia
        });

    // Esfera navideña
    var esfera = new obj4({ x: 0, y: 90, z: -50 });
    esfera.scale.set(0.5, 0.5, 0.5);
    scene.add(esfera);

    //Esfera Centrado
        esfera.addEventListener('mouseover', (event) => {  //Evento para cuando colocamos el cursor sobre la figura
          document.body.style.cursor = 'pointer';
          event.target.scale.set(0.8,0.8,0.8);
        });

        esfera.addEventListener('mouseout', (event) => {  //evento para cuando quitas el cursor de la figura, si no se agrega se le quedara el color que se puso en el mouseover
           document.body.style.cursor = 'default';
           event.target.scale.set(0.5,0.5,0.5);
        });

        esfera.addEventListener('click', (event) => { //evento para cuando se suelta el clic
          var coords = { x: camera.position.x, y: camera.position.y, z: camera.position.z };// se crea un objeto para "contener" las coordenadas
          event.target.scale.set(0.3,0.3,0.3);  
          new TWEEN.Tween(coords) //Se declara el TWEEN, que permite que los movimientos sean fluidos y no de golpe 
          .to({x:0, y:90, z: 20}) //se indican los cambios que se presentaran y en que variables, INDICA LA POSICIÓN FINAL DE MOVIMIENTO
          .onUpdate(() => camera.position.set(coords.x,coords.y,coords.z )  //Se actualizan las vartiables en el objetivo del movimiento SE ACTUALIZAN LAS VARIABLES EN LA CAMARA
          )
          .start();//El movimiento inicia
        });


    //mis objetos
      //montaña
      var montañas = new obj5({ x: 10, y: 0, z: -550 });
      montañas.scale.set(10, 10, 10);
      scene.add(montañas);

      var montañas01 = new obj5({ x: 10, y: 0, z: 550 });
      montañas01.scale.set(10, 10, 10);
      montañas01.rotation.set(0,3,0)
      scene.add(montañas01);

      var montañas02 = new obj5({ x: -550, y: 0, z: 50 });
      montañas02.scale.set(10, 10, 10);
      montañas02.rotation.set(0,1.5,0)
      scene.add(montañas02);

      var montañas03 = new obj5({ x: 550, y: 0, z: 50 });
      montañas03.scale.set(10, 10, 10);
      montañas03.rotation.set(0,-1.5,0)
      scene.add(montañas03);
      
      //casa
      var casa = new obj6({ x: 0, y: -2, z: -50});
      casa.scale.set(1.8, 1.9, 1.5);
      casa.rotation.y = -1
      scene.add(casa);
      
      //pinguino
      var pingu = new obj7({ x: 15, y: 1, z: 50 });
      pingu.scale.set(4, 4, 4);
      scene.add(pingu);

      var pingu01 = new obj7({ x: 30, y: 1, z: 70 });
      pingu01.scale.set(4, 4, 4);
      pingu01.rotation.set(0,4,0)
      scene.add(pingu01);

      //Pingüino Centrado
        pingu.addEventListener('mouseover', (event) => {  //Evento para cuando colocamos el cursor sobre la figura
          document.body.style.cursor = 'pointer';
          event.target.scale.set(4.3,4.3,4.3);
        });

        pingu.addEventListener('mouseout', (event) => {  //evento para cuando quitas el cursor de la figura, si no se agrega se le quedara el color que se puso en el mouseover
           document.body.style.cursor = 'default';
           event.target.scale.set(4,4,4);
        });

        pingu.addEventListener('click', (event) => { //evento para cuando se suelta el clic
          var coords = { x: camera.position.x, y: camera.position.y, z: camera.position.z };// se crea un objeto para "contener" las coordenadas
          event.target.scale.set(4.2,4.2,4.2);  
          new TWEEN.Tween(coords) //Se declara el TWEEN, que permite que los movimientos sean fluidos y no de golpe 
          .to({x:15, y:6, z: 80}) //se indican los cambios que se presentaran y en que variables, INDICA LA POSICIÓN FINAL DE MOVIMIENTO
          .onUpdate(() => camera.position.set(coords.x,coords.y,coords.z )  //Se actualizan las vartiables en el objetivo del movimiento SE ACTUALIZAN LAS VARIABLES EN LA CAMARA
          )
          .start();//El movimiento inicia
        });


    interactionManager.add(arbol);
    interactionManager.add(mcdonals);
    interactionManager.add(muñeco);
    interactionManager.add(esfera);
    interactionManager.add(pingu);

    // GUIA
    const g1 = new THREE.BoxGeometry(0.0075, 0.05, 0.075);
    const m1 = new THREE.MeshNormalMaterial({ side: THREE.DoubleSide });
    const meshx = new THREE.Mesh(g1, m1);
    meshx.position.set(0, 0, -1);

    const g2 = new THREE.BoxGeometry(0.05, 0.0075, 0.075);
    const m2 = new THREE.MeshNormalMaterial({ side: THREE.DoubleSide });
    const meshy = new THREE.Mesh(g2, m2);
    meshy.position.set(0, 0, -1);

    camera.add(meshx, meshy);
    scene.add(camera);



    // Render
    function render() {
      TWEEN.update();
      interactionManager.update();
      renderer.render(scene, camera);
      requestAnimationFrame(render);
    }
    render();
  </script>
</body>
</html>
